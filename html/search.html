<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
  <head>
   <title>SWISH-Enhanced:  search.cgi -- Example Perl program for searching with Swish-e and SWISH::API </title>
   <link href="./style.css" rel=stylesheet type="text/css" title="refstyle">
  </head>
  <body>

    <h1 class="banner">
        <a href="http://swish-e.org"><img border=0 src="images/swish.gif" alt="Swish-E Logo"></a><br>
        <img src="images/swishbanner1.gif"><br>
        <img src="images/dotrule1.gif"><br>
         search.cgi -- Example Perl program for searching with Swish-e and SWISH::API 
    </h1>

    <hr>

    <p>
    <div class="navbar">
      <a href="./swish.html">Prev</a> |
      <a href="./index.html">Contents</a> |
      <a href="./spider.html">Next</a>
    </div>
    <p>

    <div class="toc">
      
<A NAME="toc"></A>
<P><B>Table of Contents:</B></P>

<UL>

	<LI><A HREF="#DESCRIPTION">DESCRIPTION</A>
	<LI><A HREF="#USAGE">USAGE</A>
	<LI><A HREF="#REQUIREMENTS">REQUIREMENTS</A>
	<LI><A HREF="#SUPPORT">SUPPORT</A>
	<LI><A HREF="#AUTHOR">AUTHOR</A>
	<LI><A HREF="#LICENSE">LICENSE</A>
	<LI><A HREF="#SEE_ALSO">SEE ALSO</A>
</UL>

    </div>

    

	    [ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>

<P>
<H1><A NAME="DESCRIPTION">DESCRIPTION</A></H1>
<P>
This is a very simple program that shows how to use the SWISH::API module
in a CGI script. Unlike swish.cgi, this is suppose to not have many
built-in features. So don't ask why it doesn't do something. The point is
that this is used as a starting point that YOU customize.

<P>
This program is intended for programmers that want to create a custom
search script.

<P>
This program does require that some modules are installed from CPAN. See
REQUIREMENTS below for details and an explanation of why.

<P>
This program does not handle multiple index files, special metanames that
can be selected by drop-down boxes or anything else fancy. Again, the point
is that this script gets customized by you.

<P>
Template-Toolkit is used to render the output. The template is included
below the program code in the __DATA__ section. A Template-Toolkit
``filter'' is created to highlight terms in the description. The filter
uses the same modules that the swish.cgi script uses for highlighting.

<P>
The template can be placed in its own file if you like. That's the normal
way templates are used. It's in the __DATA__ section in this script so that
only one file is needed. If you run under mod_perl or SpeedyCGI you must
use a separate template file.

<P>
The index file is hard-coded as index.swish-e. Change it as needed. The
script uses page numbers instead of record numbers. Record numbers might be
more flexible.

<P>
This script can be run under SpeedyCGI by changing the top line to:

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    #!/usr/bin/speedy -w</pre>
        </td>
	    
      </tr>
    </table>
    <P>
and installing SpeedyCGI, of course. When run under SpeedyCGI or mod_perl
the template must be moved out into a separate file. Set the INCLUDE_PATH
to the directory where you store the template file.

<P>
The script can also be run as a mod_perl handler. If you use mod_perl you
might want to use Apache::Request instead of CGI.pm.

<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="USAGE">USAGE</A></H1>
<P>
The script is installed when Swish-e is installed. On unix-like systems
this will like be at /usr/local/lib/swish-e/search.cgi. If you used a
different --prefix option at compile time then it would be wise to look
there, instead. Windows users will find the program someplace similar, but
different. If installed as part of your OS distribution then it might be in
/usr/lib/swish-e.

<P>
Install the required modules (see next section) and then copy or symlink
the program to where you normally run CGI scripts. Use .htaccess or
whatever your web server requires to indicate that the script is indeed a
CGI script.

<P>
Create an index. If the index is not in the current working directory when
the script is run, and is not called ``index.swish-e'' (the default swish-e
index name) then modify the script to find the correct index file.

<P>
Testing CGI script from the command line first will impress your friends.

<P>
The script is lightly commented so that hopefully you can understand how it
works and thus understand how to add the features you need.

<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="REQUIREMENTS">REQUIREMENTS</A></H1>
<P>
To use this script as-is a few Perl modules will need to be installed. You
are not required to use these modules, but I like them and thus I'm
recommending that you give them a try.

<DL>
<P><DT><STRONG><A NAME="item_Template">Template-Toolkit</A></STRONG><DD>
<P>
Template-Toolkit (or TT) is available from CPAN or from

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    <A HREF="http://search.cpan/org/">http://search.cpan/org/</A>
    <A HREF="http://tt2.org/">http://tt2.org/</A></pre>
        </td>
	    
      </tr>
    </table>
    <P>
TT is used to generate the HTML output. It's good code design to separate
the output generation from the ``model'' code that does the work of
fetching the data.

<P>
I'm a big fan of Template-Toolkit. It's simple enough that it's easy to
learn how to work with basic templates. It's also not limiting and provides
power to do what's needed in the template without requiring too much setup
in the logic part of your code. Note in the code how TT works directly with
the objects returned by SWISH::API. TT's dot notation means that you can
change the backend data (e.g. from a hash to an object) and the template
does not need to change.

<P>
Please give TT a try. It's a much better use of your time than writing Yet
Another Homemade Templating System.

<P><DT><STRONG><A NAME="item_HTML">HTML::FillInForm</A></STRONG><DD>
<P>
This module is also available from CPAN

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    <A HREF="http://search.cpan.org/">http://search.cpan.org/</A></pre>
        </td>
	    
      </tr>
    </table>
    <P>
HTML::FillInForm makes HTML forms ``sticky'' -- that is, it takes previous
data from a CGI request and fills in the form elements. What this means is
you can write very plain, basic HTML forms in the template and
HTML::FillInForm will make them sticky.

<P>
The other way to have sticky forms is to use the CGI.pm module (which can
be used directly with Template-Toolkit). Besides requiring that the large
CGI.pm module gets loaded, it means there's more programming-like code in
the template, which should really just be basic HTML, and means the
template writer needs to also learn a little more Perl.

</DL>
<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="SUPPORT">SUPPORT</A></H1>
<P>
Not much support is provided. But what support is provided is ONLY provided
via the Swish-e discussion list.

<P>

    <table>
      <tr>

	<td bgcolor="#eeeeee" width="1">
	  &nbsp;
        </td>

	<td>
	  <pre>    <A HREF="http://swish-e.org/">http://swish-e.org/</A></pre>
        </td>
	    
      </tr>
    </table>
    <P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="AUTHOR">AUTHOR</A></H1>
<P>
Bill Moseley

<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="LICENSE">LICENSE</A></H1>
<P>
Copyright 2003 Bill Moseley. All rights reserved.

<P>
This program is free software; you can redistribute it and/or modify it
under the same terms as Perl itself.

<P>
[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>
<H1><A NAME="SEE_ALSO">SEE ALSO</A></H1>
<P>
<EM>SWISH</EM>,  <EM>Template</EM>, <EM>HTML</EM>



[ <B><FONT SIZE=-1><A HREF="#toc">TOC</A></FONT></B> ]
<HR>



    <p>
    <div class="navbar">
      <a href="./swish.html">Prev</a> |
      <a href="./index.html">Contents</a> |
      <a href="./spider.html">Next</a>
    </div>
    <p>

    <P ALIGN="CENTER">
    <IMG ALT="" WIDTH="470" HEIGHT="10" SRC="images/dotrule1.gif"></P>
    <P ALIGN="CENTER">

    <div class="footer">
        <BR>SWISH-E is distributed with <B>no warranty</B> under the terms of the
        <A HREF="http://www.fsf.org/copyleft/gpl.html">GNU Public License</A>,<BR>
        Free Software Foundation, Inc., 
        59 Temple Place - Suite 330, Boston, MA  02111-1307, USA<BR> 
        Public questions may be posted to 
        the <A HREF="http://swish-e.org/Discussion/">SWISH-E Discussion</A>.
    </div>

</body>
</html>
